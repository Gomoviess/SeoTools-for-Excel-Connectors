<?xml version="1.0" encoding="utf-8" ?>
<Suite Category="SEO" RequireVersion="9.5.4" Title="DataForSeo" Id="DataForSeo" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/DataForSeo.xml" HelpUrl="http://seotoolsforexcel.com/dataforseo/" HelpText="Documentation">

  <Author Name="Victor" Url="http://community.seotoolsforexcel.com/users/diskborste/activity"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/dataforseo/">
    <Text Id="Email" Title="Email" Required="true"/>
    <Text Id="Key" Title="API Password" Required="true" Password="true"/>
  </Settings>

  <Resources>
		<Resource Id="Headers">
			<RequestContentType>application/json; charset=utf-8</RequestContentType>
			<RequestHeaders>
				<Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
			</RequestHeaders>
		</Resource>
		<Resource Id="Fail">
			<Fail>
				<JsonPath Expr="$.tasks_error" Fail.If="IsNotEqual" Fail.ComparedTo="0" Fail.Action="Request" Fail.RequestId="FindError"/>
				<JsonPath Expr="$.tasks[0].status_message" Id="FindError"/>
			</Fail>
		</Resource>
    <Resource Id="SortKeywords">
			<Select Id="Sort" Title="Sort results by" DefaultValue="search_volume">
        <DataSource>
          <Item Id="search_volume" Title="Volume"/>
          <Item Id="relevance" Title="Relevance"/>
        </DataSource>
      </Select>
    </Resource>
  </Resources>

  <RestConnector Id="SerpLocations" Hidden="true">
		<Parameters>
      <Text Id="Engine"/>
		</Parameters>
   <Fetch>
		  <HttpSettings>
				<Resource Id="Headers"/>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
				https://api.dataforseo.com/v3/serp/@(Model.Engine)/locations
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[*]">
        <JsonPath Expr="location_code" Id="Id" Title="Location Code"/>
        <JsonPath Expr="location_name" Id="Name" Title="Location Name"/>
        <JsonPath Expr="country_iso_code" Id="Country Code"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="SerpLanguages" Hidden="true">
		<Parameters>
      <Text Id="Engine"/>
		</Parameters>
    <Fetch>
		  <HttpSettings>
				<Resource Id="Headers"/>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
				https://api.dataforseo.com/v3/serp/@(Model.Engine)/languages
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[*]">
        <JsonPath Expr="language_code" Id="Id" Title="Language Code"/>
        <JsonPath Expr="language_name" Id="Name" Title="Language Name"/>
        <JsonPath Expr="country_iso_code" Id="Country Code"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Locations" HelpUrl="https://docs.dataforseo.com/v3/keywords_data/google/locations/" Hidden="true">
    <Fetch>
		  <HttpSettings>
				<Resource Id="Headers"/>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/keywords_data/google/locations
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[*]">
        <JsonPath Expr="location_code" Id="Id" Title="Location Code"/>
        <JsonPath Expr="location_name" Id="Name" Title="Location Name"/>
        <JsonPath Expr="country_iso_code" Id="Country Code"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="LabLocations" HelpUrl="https://docs.dataforseo.com/v3/dataforseo_labs/locations_and_languages/?csharp" Hidden="true">
    <Fetch>
		  <HttpSettings>
				<Resource Id="Headers"/>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/dataforseo_labs/locations_and_languages
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[*]">
        <JsonPath Expr="location_code" Id="Id" Title="Location Code"/>
        <JsonPath Expr="location_name" Id="Name" Title="Name"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="LabLanguages" HelpUrl="https://docs.dataforseo.com/v3/dataforseo_labs/locations_and_languages/?csharp" Hidden="true">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Debug.DefaultValue="2752" Select.Connector="LabLocations"/>
		</Parameters>
    <Fetch>
		  <HttpSettings>
				<Resource Id="Headers"/>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/dataforseo_labs/locations_and_languages
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[?(@@.location_code==@(Model.LocationCode))].available_languages[*]">
        <JsonPath Expr="language_code" Id="Id" Title="Language Code"/>
        <JsonPath Expr="language_name" Id="Name" Title="Language Name"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Categories" HelpUrl="https://docs.dataforseo.com/keywords_data/google/categories/?csharp" Hidden="true">
    <Fetch>
		  <HttpSettings>
				<Resource Id="Headers"/>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/keywords_data/google/categories
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="$.tasks[0].result[*]">
				<JsonPath Expr="category_code" Id="Id" Title="Category Code"/>
				<JsonPath Expr="category_name" Id="Name" Title="Category Name"/>
			</JsonPath>
    </Parse>
  </RestConnector>

  <RestConnector Id="SerpInit" HelpUrl="https://docs.dataforseo.com/v3/serp/overview/?php" Hidden="true">
		<Parameters>
      <Text Id="LocationCode"/>
      <Text Id="LanguageCode"/>
      <Text Id="Keyword"/>
      <Number Id="Depth"/>
      <Text Id="Device"/>
      <Text Id="Engine"/>
		</Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/serp/@(Model.Engine)/organic/task_post
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[

					@{
						var dict = new Dictionary<string, object>();
						dict.Add("location_code", Model.LocationCode);
						dict.Add("language_code", Model.LanguageCode);
						dict.Add("keyword", Model.Keyword);
						dict.Add("depth", new string[] { Model.Depth });

						if(!string.IsNullOrEmpty(Model.Device))
						{
							dict.Add("device", Model.Device);
						}

						var postData = new List<object>();
            postData.Add(dict);
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="tasks[0].id" Id="TaskId"/>
    </Parse>
  </RestConnector>

  <RestConnector Id="SerpGoogle" Title="Google Results" HelpUrl="https://docs.dataforseo.com/v3/serp/google/organic/task_get/regular/?php" Group="SERP" HelpText="Receive SERP (Top 100) results from Google according to a certain keyword.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="SerpLocations"/>
			<Text Id="LanguageCode" Title="Language Code" Required="true" Debug.DefaultValue="sv" Select.Connector="SerpLanguages"/>
			<Text Id="Keyword" Title="Keyword" Debug.DefaultValue="&quot;sms lån&quot;" Required="true"/>
			<Number Id="Depth" Title="Depth" DefaultValue="100" Required="true" Maximum="700" HelpText="Parsing depth, max 700"/>
			<Select Id="Device" Title="Device" DefaultValue="desktop">
        <DataSource>
          <Item Id="desktop" Title="Desktop"/>
          <Item Id="mobile" Title="Mobile"/>
        </DataSource>
      </Select>
			<Text Id="Engine" DefaultValue="google" Hidden="true"/>
    </Parameters>
    <Prepare>
      <Connector Id="SerpInit" Parameters="LocationCode,LanguageCode,Keyword,Depth,Device,Engine"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/serp/google/organic/task_get/regular/@(Model.TaskId)
        ]]>
      </Fetch.Url>
      <HttpSettings>
				<Resource Id="Headers"/>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[0].items[*]">
        <JsonPath Expr="rank_group" Id="SerpRankGroup" Title="SERP Rank Group" Converter="Auto"/>
        <JsonPath Expr="rank_absolute" Id="SerpRankAbsolute" Title="SERP Rank Absolute" Converter="Auto"/>
        <JsonPath Expr="type" Id="SerpType" Title="SERP Type"/>
        <JsonPath Expr="domain" Id="Domain" Title="Domain"/>
        <JsonPath Expr="url" Id="SerpUrl" Title="SERP URL"/>
        <JsonPath Expr="title" Id="SerpTitle" Title="SERP Title"/>
        <JsonPath Expr="breadcrumb" Id="SerpBreadcrumb" Title="SERP Breadcrumb"/>
        <JsonPath Expr="description" Id="SerpDescription" Title="SERP Description"/>
      </JsonPath>
    </Parse>
    <Fail>
			<JsonPath Expr="$.tasks[0].status_code" Fail.If="IsEqual" Fail.ComparedTo="40602" Fail.Action="Retry" Fail.RetryAfter="5000" Fail.RetryTimes="100"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="SerpBing" Title="Bing Results" HelpUrl="https://docs.dataforseo.com/v3/serp/bing/organic/task_get/regular/?php" Group="SERP" HelpText="Receive SERP (Top 100) results from Bing according to a certain keyword.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="SerpLocations"/>
			<Text Id="LanguageCode" Title="Language Code" Required="true" Debug.DefaultValue="sv" Select.Connector="SerpLanguages"/>
			<Text Id="Keyword" Title="Keyword" Debug.DefaultValue="&quot;sms lån&quot;" Required="true"/>
			<Number Id="Depth" Title="Depth" DefaultValue="100" Required="true" Maximum="700" HelpText="Parsing depth, max 700"/>
			<Select Id="Device" Title="Device" DefaultValue="desktop">
        <DataSource>
          <Item Id="desktop" Title="Desktop"/>
          <Item Id="mobile" Title="Mobile"/>
        </DataSource>
      </Select>
			<Text Id="Engine" DefaultValue="bing" Hidden="true"/>
    </Parameters>
    <Prepare>
      <Connector Id="SerpInit" Parameters="LocationCode,LanguageCode,Keyword,Device,Depth,Engine"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/serp/bing/organic/task_get/regular/@(Model.TaskId)
        ]]>
      </Fetch.Url>
      <HttpSettings>
				<Resource Id="Headers"/>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[0].items[*]">
        <JsonPath Expr="rank_group" Id="SerpRankGroup" Title="SERP Rank Group" Converter="Auto"/>
        <JsonPath Expr="rank_absolute" Id="SerpRankAbsolute" Title="SERP Rank Absolute" Converter="Auto"/>
        <JsonPath Expr="type" Id="SerpType" Title="SERP Type"/>
        <JsonPath Expr="domain" Id="Domain" Title="Domain"/>
        <JsonPath Expr="url" Id="SerpUrl" Title="SERP URL"/>
        <JsonPath Expr="title" Id="SerpTitle" Title="SERP Title"/>
        <JsonPath Expr="breadcrumb" Id="SerpBreadcrumb" Title="SERP Breadcrumb"/>
        <JsonPath Expr="description" Id="SerpDescription" Title="SERP Description"/>
      </JsonPath>
    </Parse>
    <Fail>
			<JsonPath Expr="$.tasks[0].status_code" Fail.If="IsEqual" Fail.ComparedTo="40602" Fail.Action="Retry" Fail.RetryAfter="5000" Fail.RetryTimes="100"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="SerpYahoo" Title="Yahoo Results" HelpUrl="https://docs.dataforseo.com/v3/serp/yahoo/organic/task_get/regular/?php" Group="SERP" HelpText="Receive SERP (Top 100) results from Yahoo according to a certain keyword.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="SerpLocations"/>
			<Text Id="LanguageCode" Title="Language Code" Required="true" Debug.DefaultValue="sv" Select.Connector="SerpLanguages"/>
			<Text Id="Keyword" Title="Keyword" Debug.DefaultValue="&quot;sms lån&quot;" Required="true"/>
			<Number Id="Depth" Title="Depth" DefaultValue="100" Required="true" Maximum="700" HelpText="Parsing depth, max 700"/>
			<Text Id="Device" Hidden="true"/>
			<Text Id="Engine" DefaultValue="bing" Hidden="true"/>
    </Parameters>
    <Prepare>
      <Connector Id="SerpInit" Parameters="LocationCode,LanguageCode,Keyword,Device,Depth,Engine"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/serp/yahoo/organic/task_get/regular/@(Model.TaskId)
        ]]>
      </Fetch.Url>
      <HttpSettings>
				<Resource Id="Headers"/>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[0].items[*]">
        <JsonPath Expr="rank_group" Id="SerpRankGroup" Title="SERP Rank Group" Converter="Auto"/>
        <JsonPath Expr="rank_absolute" Id="SerpRankAbsolute" Title="SERP Rank Absolute" Converter="Auto"/>
        <JsonPath Expr="type" Id="SerpType" Title="SERP Type"/>
        <JsonPath Expr="domain" Id="Domain" Title="Domain"/>
        <JsonPath Expr="url" Id="SerpUrl" Title="SERP URL"/>
        <JsonPath Expr="title" Id="SerpTitle" Title="SERP Title"/>
        <JsonPath Expr="breadcrumb" Id="SerpBreadcrumb" Title="SERP Breadcrumb"/>
        <JsonPath Expr="description" Id="SerpDescription" Title="SERP Description"/>
      </JsonPath>
    </Parse>
    <Fail>
			<JsonPath Expr="$.tasks[0].status_code" Fail.If="IsEqual" Fail.ComparedTo="40602" Fail.Action="Retry" Fail.RetryAfter="5000" Fail.RetryTimes="100"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="SearchVolume" Title="Search Volume" Group="Keywords LIVE" HelpUrl="https://docs.dataforseo.com/v3/keywords_data/google/search_volume/live/?csharp" HelpText="Receive search statistics for one or more keywords">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="Locations"/>
			<Text Id="Keyword" Title="Keyword(s)" Debug.DefaultValue="trump" Multiline="true" Required="true"/>
			<Checkbox Id="Partners" Title="Google Search Partners" HelpText="If true, the results will be delivered for Google and search partners."/>
			<Resource Id="SortKeywords"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/keywords_data/google/search_volume/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
					  var postData = new List<object>();
            postData.Add(new
            {
							location_code = Model.LocationCode,
							search_partners = Model.Partners,
							sort_by = Model.Sort,
							keywords = CreateArr(700)
            });
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[*]">
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String"/>
        <JsonPath Expr="se_results_count" Id="Results" Title="Results" Converter="Int"/>
        <JsonPath Expr="items_count" Id="CPC" Title="CPC" Converter="Double"/>
        <JsonPath Expr="search_volume" Id="Volume" Title="Volume" Converter="Double"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="SearchVolumeMonthly" Title="Search Volume Monthly" Group="Keywords HISTORIC" HelpUrl="https://docs.dataforseo.com/v3/keywords_data/google/search_volume/live/?csharp" HelpText="Receive search volume trends for the last year.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="Locations"/>
			<Text Id="Keyword" Title="Keyword(s)" Debug.DefaultValue="trump" Multiline="true" Required="true"/>
			<Checkbox Id="Partners" Title="Google Search Partners" HelpText="If true, the results will be delivered for Google and search partners."/>
			<Resource Id="SortKeywords"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/keywords_data/google/search_volume/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
					  var postData = new List<object>();
            postData.Add(new
            {
							location_code = Model.LocationCode,
							search_partners = Model.Partners,
							sort_by = Model.Sort,
							keywords = CreateArr(700)
            });
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <Xpath Expr="//monthly_searches/search_volume">
				<Xpath Expr="../../keyword" Id="Keyword"/>
				<Xpath Expr="../year" Id="Year" Converter="Int"/>
				<Xpath Expr="../month" Id="Month" Converter="Int"/>
				<Xpath Expr="." Id="Volume" Converter="Int"/>
      </Xpath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="KeywordsDomain" Title="Keywords for Domain" Group="Keywords LIVE" HelpUrl="https://docs.dataforseo.com/v3/keywords_data/google/keywords_for_site/live/?csharp" HelpText="Receive keyword statistics for one domain.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="Locations"/>
			<Text Id="Domain" Title="Domain" Debug.DefaultValue="seotoolsforexcel.com" Required="true"/>
			<Resource Id="SortKeywords"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/keywords_data/google/keywords_for_site/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
					  var postData = new List<object>();
            postData.Add(new
            {
							location_code = Model.LocationCode,
							sort_by = Model.Sort,
							target = Model.Domain
            });
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[*]">
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String"/>
        <JsonPath Expr="competition" Id="Competition" Title="Competition" Converter="Double"/>
        <JsonPath Expr="cpc" Id="CPC" Title="CPC" Converter="Double"/>
        <JsonPath Expr="search_volume" Id="Volume" Title="Volume" Converter="Double"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="KeywordsDomainMonthly" Title="Keywords for Domain Monthly" Group="Keywords HISTORIC" HelpUrl="https://docs.dataforseo.com/v3/keywords_data/google/keywords_for_site/live/?csharp" HelpText="Receive keyword statistics for one domain for the last year.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="Locations"/>
			<Text Id="Domain" Title="Domain" Debug.DefaultValue="seotoolsforexcel.com" Required="true"/>
			<Resource Id="SortKeywords"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/keywords_data/google/keywords_for_site/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
					  var postData = new List<object>();
            postData.Add(new
            {
							location_code = Model.LocationCode,
							sort_by = Model.Sort,
							target = Model.Domain
            });
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <Xpath Expr="//monthly_searches/search_volume">
				<Xpath Expr="../../keyword" Id="Keyword"/>
				<Xpath Expr="../year" Id="Year" Converter="Int"/>
				<Xpath Expr="../month" Id="Month" Converter="Int"/>
				<Xpath Expr="." Id="Volume" Converter="Int"/>
      </Xpath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="KeywordsKeywords" Title="Keywords for Keywords" Group="Keywords LIVE" HelpUrl="https://docs.dataforseo.com/v3/keywords_data/google/keywords_for_keywords/live/?csharp" HelpText="Receive keyword suggestions for one or more keywords.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="Locations"/>
			<Text Id="Keyword" Title="Keyword(s)" Debug.DefaultValue="trump" Multiline="true" Required="true"/>
			<Checkbox Id="Partners" Title="Google Search Partners" HelpText="If true, the results will be delivered for Google and search partners."/>
			<Resource Id="SortKeywords"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/keywords_data/google/keywords_for_keywords/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
					  var postData = new List<object>();
            postData.Add(new
            {
							location_code = Model.LocationCode,
							search_partners = Model.Partners,
							sort_by = Model.Sort,
							keywords = CreateArr(200)
            });
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[*]">
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String"/>
        <JsonPath Expr="competition" Id="Competition" Title="Competition" Converter="Double"/>
        <JsonPath Expr="cpc" Id="CPC" Title="CPC" Converter="Double"/>
        <JsonPath Expr="search_volume" Id="Volume" Title="Volume" Converter="Double"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="KeywordsKeywordsMonthly" Title="Keywords for Keywords Monthly" Group="Keywords HISTORIC" HelpUrl="https://docs.dataforseo.com/v3/keywords_data/google/keywords_for_keywords/live/?csharp" HelpText="Receive keyword suggestions for one or more keywords for the last year.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="Locations"/>
			<Text Id="Keyword" Title="Keyword(s)" Debug.DefaultValue="trump" Multiline="true" Required="true"/>
			<Checkbox Id="Partners" Title="Google Search Partners" HelpText="If true, the results will be delivered for Google and search partners."/>
			<Resource Id="SortKeywords"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/keywords_data/google/keywords_for_keywords/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
					  var postData = new List<object>();
            postData.Add(new
            {
							location_code = Model.LocationCode,
							search_partners = Model.Partners,
							sort_by = Model.Sort,
							keywords = CreateArr(200)
            });
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <Xpath Expr="//monthly_searches/search_volume">
				<Xpath Expr="../../keyword" Id="Keyword"/>
				<Xpath Expr="../year" Id="Year" Converter="Int"/>
				<Xpath Expr="../month" Id="Month" Converter="Int"/>
				<Xpath Expr="." Id="Volume" Converter="Int"/>
      </Xpath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="KeywordsCategories" Title="Keywords for Categories" Group="Keywords LIVE" HelpUrl="https://docs.dataforseo.com/v3/keywords_data/google/keywords_for_category/live/?csharp" HelpText="Receive keyword for one product category.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="Locations"/>
			<Text Id="CategoryCode" Title="Category Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="10021" Select.Connector="Categories"/>
			<Checkbox Id="Partners" Title="Google Search Partners" HelpText="If true, the results will be delivered for Google and search partners."/>
			<Resource Id="SortKeywords"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/keywords_data/google/keywords_for_category/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
					  var postData = new List<object>();
            postData.Add(new
            {
							location_code = Model.LocationCode,
							search_partners = Model.Partners,
							sort_by = Model.Sort,
							category_code = Model.CategoryCode
            });
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[*]">
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String"/>
        <JsonPath Expr="competition" Id="Competition" Title="Competition" Converter="Double"/>
        <JsonPath Expr="cpc" Id="CPC" Title="CPC" Converter="Double"/>
        <JsonPath Expr="search_volume" Id="Volume" Title="Volume" Converter="Double"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="KeywordsCategoriesMonthly" Title="Keywords for Categories Monthly" Group="Keywords HISTORIC" HelpUrl="https://docs.dataforseo.com/v3/keywords_data/google/keywords_for_category/live/?csharp" HelpText="Receive keyword for one product category for the last year.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="Locations"/>
			<Text Id="CategoryCode" Title="Category Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="10021" Select.Connector="Categories"/>
			<Checkbox Id="Partners" Title="Google Search Partners" HelpText="If true, the results will be delivered for Google and search partners."/>
			<Resource Id="SortKeywords"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/keywords_data/google/keywords_for_category/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
					  var postData = new List<object>();
            postData.Add(new
            {
							location_code = Model.LocationCode,
							search_partners = Model.Partners,
							sort_by = Model.Sort,
							category_code = Model.CategoryCode
            });
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <Xpath Expr="//monthly_searches/search_volume">
				<Xpath Expr="../../keyword" Id="Keyword"/>
				<Xpath Expr="../year" Id="Year" Converter="Int"/>
				<Xpath Expr="../month" Id="Month" Converter="Int"/>
				<Xpath Expr="." Id="Volume" Converter="Int"/>
      </Xpath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AdsTrafficKeywords" Title="Ads Traffic for Keywords" Group="Keywords LIVE" HelpUrl="https://docs.dataforseo.com/v3/keywords_data/google/ad_traffic_by_keywords/live/?csharp" HelpText="Receive Ads stats for daily impressions, CPC and clicks estimation.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="Locations"/>
			<Text Id="Keyword" Title="Keyword(s)" Debug.DefaultValue="trump" Multiline="true" Required="true"/>
      <Number Id="Bid" Title="Bid" DefaultValue="100" Required="true" Format="N1" HelpText="The price you are willing to pay for an ad; the higher value you specify, the higher positions and price you will get."/>
      <Select Id="Match" Title="Match" DefaultValue="exact">
        <DataSource>
          <Item Id="exact" Title="Exact" />
          <Item Id="broad" Title="Broad" />
          <Item Id="phrase" Title="Phrase" />
        </DataSource>
      </Select>
		</Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/keywords_data/google/ad_traffic_by_keywords/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
					  var postData = new List<object>();
            postData.Add(new
            {
							location_code = Model.LocationCode,
							match = Model.Match,
							bid = Model.Bid,
							keywords = CreateArr(2500)
            });
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[*]">
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String" Checked="true"/>
        <JsonPath Expr="ad_position_min" Id="AdPositionMin" Title="Ad Position Min" Converter="Double" Checked="true"/>
        <JsonPath Expr="ad_position_max" Id="AdPositionMax" Title="Ad Position Max" Converter="Double" Checked="true"/>
        <JsonPath Expr="ad_position_average" Id="AdPositionAvg" Title="Ad Position Avg" Converter="Double" Checked="true"/>
        <JsonPath Expr="cpc_min" Id="CPCMin" Title="CPC Min" Converter="Double" Checked="true"/>
        <JsonPath Expr="cpc_max" Id="CPCMax" Title="CPC Max" Converter="Double" Checked="true"/>
        <JsonPath Expr="cpc_average" Id="CPCAvg" Title="CPC Avg" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_impressions_min" Id="DailyImpressionsMin" Title="Daily Impressions Min" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_impressions_max" Id="DailyImpressionsMax" Title="Daily Impressions Max" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_impressions_average" Id="DailyImpressionsAvg" Title="Daily Impressions Avg" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_clicks_min" Id="DailyClicksMin" Title="Daily Clicks Min" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_clicks_max" Id="DailyClicksMax" Title="Daily Clicks Max" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_clicks_average" Id="DailyClicksAvg" Title="Daily Clicks Avg" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_cost_min" Id="DailyCostMin" Title="Daily Cost Min" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_cost_max" Id="DailyCostMax" Title="Daily Cost Max" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_cost_average" Id="DailyCostAvg" Title="Daily Cost Avg" Converter="Double" Checked="true"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AdsTrafficPlatforms" Title="Ads Traffic by Platforms" Group="Keywords LIVE" HelpUrl="https://docs.dataforseo.com/v3/keywords_data/google/ad_traffic_by_platforms/live/?csharp" HelpText="Receive Ads stats based on one platform. You will get overall information for a group of keywords you send.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="Locations"/>
			<Text Id="Keyword" Title="Keyword(s)" Debug.DefaultValue="trump" Multiline="true" Required="true"/>
      <Number Id="Bid" Title="Bid" DefaultValue="100" Required="true" Format="N1" HelpText="The price you are willing to pay for an ad; the higher value you specify, the higher positions and price you will get."/>
      <Select Id="Platform" Title="Platform" DefaultValue="desktop">
        <DataSource>
          <Item Id="desktop" Title="Desktop" />
          <Item Id="mobile" Title="Mobile" />
          <Item Id="tablet" Title="Tablet" />
        </DataSource>
      </Select>
			<Select Id="Match" Title="Match" DefaultValue="exact">
        <DataSource>
          <Item Id="exact" Title="Exact" />
          <Item Id="broad" Title="Broad" />
          <Item Id="phrase" Title="Phrase" />
        </DataSource>
      </Select>
		</Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/keywords_data/google/ad_traffic_by_platforms/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
					  var postData = new List<object>();
            postData.Add(new
            {
							location_code = Model.LocationCode,
							match = Model.Match,
							bid = Model.Bid,
							keywords = CreateArr(2500)
            });
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[0].@(Model.Platform)">
        <JsonPath Expr="ad_position_min" Id="AdPositionMin" Title="Ad Position Min" Converter="Double" Checked="true"/>
        <JsonPath Expr="ad_position_max" Id="AdPositionMax" Title="Ad Position Max" Converter="Double" Checked="true"/>
        <JsonPath Expr="ad_position_average" Id="AdPositionAvg" Title="Ad Position Avg" Converter="Double" Checked="true"/>
        <JsonPath Expr="cpc_min" Id="CPCMin" Title="CPC Min" Converter="Double" Checked="true"/>
        <JsonPath Expr="cpc_max" Id="CPCMax" Title="CPC Max" Converter="Double" Checked="true"/>
        <JsonPath Expr="cpc_average" Id="CPCAvg" Title="CPC Avg" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_impressions_min" Id="DailyImpressionsMin" Title="Daily Impressions Min" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_impressions_max" Id="DailyImpressionsMax" Title="Daily Impressions Max" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_impressions_average" Id="DailyImpressionsAvg" Title="Daily Impressions Avg" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_clicks_min" Id="DailyClicksMin" Title="Daily Clicks Min" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_clicks_max" Id="DailyClicksMax" Title="Daily Clicks Max" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_clicks_average" Id="DailyClicksAvg" Title="Daily Clicks Avg" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_cost_min" Id="DailyCostMin" Title="Daily Cost Min" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_cost_max" Id="DailyCostMax" Title="Daily Cost Max" Converter="Double" Checked="true"/>
        <JsonPath Expr="daily_cost_average" Id="DailyCostAvg" Title="Daily Cost Avg" Converter="Double" Checked="true"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="RelatedKeywords" Title="Related Keywords" Group="Labs RESEARCH" HelpUrl="https://docs.dataforseo.com/v3/dataforseo_labs/related_keywords/live/?csharp" HelpText="Get keywords that are related to a keyword you are going to provide.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="LabLocations"/>
			<Text Id="LanguageCode" Title="Language Code" Required="true" Debug.DefaultValue="sv" Select.Connector="LabLanguages"/>
			<Text Id="Keyword" Title="Keyword" Debug.DefaultValue="trump" Required="true"/>
			<Text Id="Filter" Title="Filter" HelpText="Click this icon to see example filters, ie: [&quot;keyword_data.keyword_info.search_volume&quot;,&quot;>&quot;,0]" HelpUrl="https://docs.dataforseo.com/v3/dataforseo_labs/related_keywords/live/?csharp"/>
      <Select Id="Depth" Title="Depth" Required="true" DefaultValue="2">
        <DataSource>
					<Item Id="1" Title="8 keywords"/>
					<Item Id="2" Title="72 keywords"/>
					<Item Id="3" Title="584 keywords"/>
					<Item Id="4" Title="4680 keywords"/>
        </DataSource>
      </Select>
			<Select Id="Sort" Title="Sort results by">
        <DataSource>
          <Item Id="keyword_data.keyword_info.search_volume,desc" Title="Volume Desc"/>
          <Item Id="keyword_data.keyword_info.search_volume,asc" Title="Volume Asc"/>
          <Item Id="keyword_data.keyword_info.competition,desc" Title="Competition Desc"/>
          <Item Id="keyword_data.keyword_info.competition,asc" Title="Competition Asc"/>
          <Item Id="keyword_data.keyword_info.cpc,desc" Title="CPC Desc"/>
          <Item Id="keyword_data.keyword_info.cpc,asc" Title="CPC Asc"/>
        </DataSource>
      </Select>
		</Parameters>
		<Paging PageSize="100" EvenPages="true"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/dataforseo_labs/related_keywords/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
						var dict = new Dictionary<string, object>();
						dict.Add("location_code", Model.LocationCode);
						dict.Add("language_code", Model.LanguageCode);
						dict.Add("depth", Model.Depth);
						dict.Add("keyword", Model.Keyword);
						dict.Add("order_by", new string[] { Model.Sort });
						dict.Add("limit", Model.PageCursor.NextTake);
						dict.Add("offset", Model.PageCursor.NextSkip);

						if(!string.IsNullOrEmpty(Model.Filter))
						{
							var deserialized = JsonConvert.DeserializeObject(Model.Filter);
							dict.Add("filters", deserialized);
						}

						var postData = new List<object>();
            postData.Add(dict);
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[0].items[*]">
        <JsonPath Expr="keyword_data.keyword" Id="Keyword" Title="Keyword" Converter="String"/>
        <JsonPath Expr="keyword_data.keyword_info.competition" Id="Competition" Title="Competition" Converter="Double"/>
        <JsonPath Expr="keyword_data.keyword_info.cpc" Id="CPC" Title="CPC" Converter="Double"/>
        <JsonPath Expr="keyword_data.keyword_info.search_volume" Id="Volume" Title="Volume" Converter="Double"/>
        <JsonPath Expr="depth" Id="Depth" Title="Depth" Converter="Auto"/>
        <JsonPath Expr="keyword_data.impressions_info.ad_position_min" Id="AdPositionMin" Title="Ad Position Min" Converter="Auto"/>
        <JsonPath Expr="keyword_data.impressions_info.ad_position_max" Id="AdPositionMax" Title="Ad Position Max" Converter="Auto"/>
        <JsonPath Expr="keyword_data.impressions_info.ad_position_average" Id="AdPositionAvg" Title="Ad Position Avg" Converter="Auto"/>
        <JsonPath Expr="keyword_data.impressions_info.cpc_min" Id="CPCMin" Title="CPC Min" Converter="Auto"/>
        <JsonPath Expr="keyword_data.impressions_info.cpc_max" Id="CPCMax" Title="CPC Max" Converter="Auto"/>
        <JsonPath Expr="keyword_data.impressions_info.cpc_average" Id="CPCAvg" Title="CPC Avg" Converter="Auto"/>
        <JsonPath Expr="keyword_data.impressions_info.daily_impressions_min" Id="DailyImpressionsMin" Title="Daily Impressions Min" Converter="Auto"/>
        <JsonPath Expr="keyword_data.impressions_info.daily_impressions_max" Id="DailyImpressionsMax" Title="Daily Impressions Max" Converter="Auto"/>
        <JsonPath Expr="keyword_data.impressions_info.daily_impressions_average" Id="DailyImpressionsAvg" Title="Daily Impressions Avg" Converter="Auto"/>
        <JsonPath Expr="keyword_data.impressions_info.daily_clicks_min" Id="DailyClicksMin" Title="Daily Clicks Min" Converter="Auto"/>
        <JsonPath Expr="keyword_data.impressions_info.daily_clicks_max" Id="DailyClicksMax" Title="Daily Clicks Max" Converter="Auto"/>
        <JsonPath Expr="keyword_data.impressions_info.daily_clicks_average" Id="DailyClicksAvg" Title="Daily Clicks Avg" Converter="Auto"/>
        <JsonPath Expr="keyword_data.impressions_info.daily_cost_min" Id="DailyCostMin" Title="Daily Cost Min" Converter="Auto"/>
        <JsonPath Expr="keyword_data.impressions_info.daily_cost_max" Id="DailyCostMax" Title="Daily Cost Max" Converter="Auto"/>
        <JsonPath Expr="keyword_data.impressions_info.daily_cost_average" Id="DailyCostAvg" Title="Daily Cost Avg" Converter="Auto"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="KeywordSuggestions" Title="Keyword Suggestions" Group="Labs RESEARCH" HelpUrl="https://docs.dataforseo.com/v3/dataforseo_labs/keyword_suggestions/live/?csharp" HelpText="Based on the full-text search for the specified keyword. Returns only those search terms that contain the keyword you requested with additional words before, after, or within the specified key phrase.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="LabLocations"/>
			<Text Id="LanguageCode" Title="Language Code" Required="true" Debug.DefaultValue="sv" Select.Connector="LabLanguages"/>
			<Text Id="Keyword" Title="Keyword" Debug.DefaultValue="trump" Required="true"/>
			<Text Id="Filter" Title="Filter" HelpText="Click this icon to see example filters, ie: [&quot;keyword_info.search_volume&quot;,&quot;>&quot;,0]" HelpUrl="https://docs.dataforseo.com/v3/dataforseo_labs/keyword_suggestions/live/?csharp"/>
			<Select Id="Sort" Title="Sort results by">
        <DataSource>
          <Item Id="keyword_info.search_volume,desc" Title="Volume Desc"/>
          <Item Id="keyword_info.search_volume,asc" Title="Volume Asc"/>
          <Item Id="keyword_info.competition,desc" Title="Competition Desc"/>
          <Item Id="keyword_info.competition,asc" Title="Competition Asc"/>
          <Item Id="keyword_info.cpc,desc" Title="CPC Desc"/>
          <Item Id="keyword_info.cpc,asc" Title="CPC Asc"/>
        </DataSource>
      </Select>
		</Parameters>
		<Paging PageSize="100" EvenPages="true"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/dataforseo_labs/keyword_suggestions/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
						var dict = new Dictionary<string, object>();
						dict.Add("location_code", Model.LocationCode);
						dict.Add("language_code", Model.LanguageCode);
						dict.Add("keyword", Model.Keyword);
						dict.Add("order_by", new string[] { Model.Sort });
						dict.Add("limit", Model.PageCursor.NextTake);
						dict.Add("offset", Model.PageCursor.NextSkip);

						if(!string.IsNullOrEmpty(Model.Filter))
						{
							var deserialized = JsonConvert.DeserializeObject(Model.Filter);
							dict.Add("filters", deserialized);
						}

						var postData = new List<object>();
            postData.Add(dict);
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[0].items[*]">
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String"/>
        <JsonPath Expr="keyword_info.competition" Id="Competition" Title="Competition" Converter="Double"/>
        <JsonPath Expr="keyword_info.cpc" Id="CPC" Title="CPC" Converter="Double"/>
        <JsonPath Expr="keyword_info.search_volume" Id="Volume" Title="Volume" Converter="Double"/>
        <JsonPath Expr="impressions_info.ad_position_min" Id="AdPositionMin" Title="Ad Position Min" Converter="Auto"/>
        <JsonPath Expr="impressions_info.ad_position_max" Id="AdPositionMax" Title="Ad Position Max" Converter="Auto"/>
        <JsonPath Expr="impressions_info.ad_position_average" Id="AdPositionAvg" Title="Ad Position Avg" Converter="Auto"/>
        <JsonPath Expr="impressions_info.cpc_min" Id="CPCMin" Title="CPC Min" Converter="Auto"/>
        <JsonPath Expr="impressions_info.cpc_max" Id="CPCMax" Title="CPC Max" Converter="Auto"/>
        <JsonPath Expr="impressions_info.cpc_average" Id="CPCAvg" Title="CPC Avg" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_impressions_min" Id="DailyImpressionsMin" Title="Daily Impressions Min" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_impressions_max" Id="DailyImpressionsMax" Title="Daily Impressions Max" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_impressions_average" Id="DailyImpressionsAvg" Title="Daily Impressions Avg" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_clicks_min" Id="DailyClicksMin" Title="Daily Clicks Min" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_clicks_max" Id="DailyClicksMax" Title="Daily Clicks Max" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_clicks_average" Id="DailyClicksAvg" Title="Daily Clicks Avg" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_cost_min" Id="DailyCostMin" Title="Daily Cost Min" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_cost_max" Id="DailyCostMax" Title="Daily Cost Max" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_cost_average" Id="DailyCostAvg" Title="Daily Cost Avg" Converter="Auto"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="RankedKeywords" Title="Ranked Keywords" Group="Labs RESEARCH" HelpUrl="https://docs.dataforseo.com/v3/dataforseo_labs/ranked_keywords/live/?csharp" HelpText="Get keywords for which a website is ranked.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="LabLocations"/>
			<Text Id="LanguageCode" Title="Language Code" Required="true" Debug.DefaultValue="sv" Select.Connector="LabLanguages"/>
			<Text Id="Domain" Title="Domain" Debug.DefaultValue="microsoft.com" Required="true"/>
			<Text Id="Filter" Title="Filter" HelpText="Click this icon to see example filters, ie: [&quot;ranked_serp_element.serp_item.rank_group&quot;,&quot;&lt;=&quot;,10]" HelpUrl="https://docs.dataforseo.com/v3/dataforseo_labs/ranked_keywords/live/?csharp"/>
			<Select Id="Sort" Title="Sort results by">
        <DataSource>
          <Item Id="keyword_data.keyword_info.search_volume,desc" Title="Volume Desc"/>
          <Item Id="keyword_data.keyword_info.search_volume,asc" Title="Volume Asc"/>
          <Item Id="keyword_data.keyword_info.competition,desc" Title="Competition Desc"/>
          <Item Id="keyword_data.keyword_info.competition,asc" Title="Competition Asc"/>
          <Item Id="keyword_data.keyword_info.cpc,desc" Title="CPC Desc"/>
          <Item Id="keyword_data.keyword_info.cpc,asc" Title="CPC Asc"/>
        </DataSource>
      </Select>
		</Parameters>
		<Paging PageSize="100" EvenPages="true"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/dataforseo_labs/ranked_keywords/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
						var dict = new Dictionary<string, object>();
						dict.Add("location_code", Model.LocationCode);
						dict.Add("language_code", Model.LanguageCode);
						dict.Add("target", Model.Domain);
						dict.Add("order_by", new string[] { Model.Sort });
						dict.Add("limit", Model.PageCursor.NextTake);
						dict.Add("offset", Model.PageCursor.NextSkip);

						if(!string.IsNullOrEmpty(Model.Filter))
						{
							var deserialized = JsonConvert.DeserializeObject(Model.Filter);
							dict.Add("filters", deserialized);
						}

						var postData = new List<object>();
            postData.Add(dict);
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[0].items[*]">
        <JsonPath Expr="keyword_data.keyword" Id="Keyword" Title="Keyword" Converter="String"/>
        <JsonPath Expr="keyword_data.keyword_info.competition" Id="Competition" Title="Competition" Converter="Double"/>
        <JsonPath Expr="keyword_data.keyword_info.cpc" Id="CPC" Title="CPC" Converter="Double"/>
        <JsonPath Expr="keyword_data.keyword_info.search_volume" Id="Volume" Title="Volume" Converter="Double"/>
        <JsonPath Expr="ranked_serp_element.serp_item.etv" Id="SerpEtv" Title="SERP ETV" Converter="Double"/>
        <JsonPath Expr="ranked_serp_element.serp_item.estimated_paid_traffic_cost" Id="SerpTrafficCost" Title="SERP Traffic Cost" Converter="Double"/>
        <JsonPath Expr="ranked_serp_element.serp_item.rank_group" Id="SerpRankGroup" Title="SERP Rank Group" Converter="Auto"/>
        <JsonPath Expr="ranked_serp_element.serp_item.rank_absolute" Id="SerpRankAbsolute" Title="SERP Rank Absolute" Converter="Auto"/>
        <JsonPath Expr="ranked_serp_element.serp_item.type" Id="SerpType" Title="SERP Type"/>
        <JsonPath Expr="ranked_serp_element.serp_item.position" Id="SerpPosition" Title="SERP Position"/>
        <JsonPath Expr="ranked_serp_element.serp_item.title" Id="SerpTitle" Title="SERP Title"/>
        <JsonPath Expr="ranked_serp_element.serp_item.url" Id="SerpUrl" Title="SERP URL"/>
        <JsonPath Expr="ranked_serp_element.serp_item.breadcrumb" Id="SerpBreadcrumb" Title="SERP Breadcrumb"/>
        <JsonPath Expr="ranked_serp_element.serp_item.description" Id="SerpDescription" Title="SERP Description"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="RelevantPages" Title="Relevant Pages" Group="Labs RESEARCH" HelpUrl="https://docs.dataforseo.com/v3/dataforseo_labs/relevant_pages/live/?php" HelpText="Get SERP metrics for relevant pages of a website based on a specific location.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="LabLocations"/>
			<Text Id="LanguageCode" Title="Language Code" Required="true" Debug.DefaultValue="sv" Select.Connector="LabLanguages"/>
			<Text Id="Domain" Title="Domain" Debug.DefaultValue="microsoft.com" Required="true"/>
			<Text Id="Filter" Title="Filter" HelpText="Click this icon to see example filters, ie: [&quot;metrics.paid.count&quot;,&quot;&gt;&quot;,0]" HelpUrl="https://docs.dataforseo.com/v3/dataforseo_labs/relevant_pages/live/?php"/>
			<Select Id="Sort" Title="Sort results by">
        <DataSource>
          <Item Id="metrics.organic.count,desc" Title="Count Organic Desc"/>
          <Item Id="metrics.organic.count,asc" Title="Count Organic Asc"/>
          <Item Id="metrics.paid.count,desc" Title="Count Paid Desc"/>
          <Item Id="metrics.paid.count,asc" Title="Count Paid Asc"/>
          <Item Id="metrics.organic.etv,desc" Title="ETV Organic Desc"/>
          <Item Id="metrics.organic.etv,asc" Title="ETV Organic Asc"/>
          <Item Id="metrics.paid.etv,desc" Title="ETV Paid Desc"/>
          <Item Id="metrics.paid.organic_et,asc" Title="ETV Paid Asc"/>
          <Item Id="metrics.organic.estimated_paid_traffic_cost,desc" Title="Paid Traffic Cost Organic Desc"/>
          <Item Id="metrics.organic.estimated_paid_traffic_cost,asc" Title="Paid Traffic Cost Organic Asc"/>
          <Item Id="metrics.paid.estimated_paid_traffic_cost,desc" Title="Paid Traffic Cost Paid Desc"/>
          <Item Id="metrics.paid.estimated_paid_traffic_cost,asc" Title="Paid Traffic Cost Paid Asc"/>
          <Item Id="metrics.organic.impressions_etv,desc" Title="Impressions ETV Organic Desc"/>
          <Item Id="metrics.organic.impressions_etv,asc" Title="Impressions ETV Organic Asc"/>
          <Item Id="metrics.paid.impressions_etv,desc" Title="Impressions ETV Paid Desc"/>
          <Item Id="metrics.paid.impressions_etv,asc" Title="Impressions ETV Paid Asc"/>
        </DataSource>
      </Select>
		</Parameters>
		<Paging PageSize="100" EvenPages="true"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/dataforseo_labs/relevant_pages/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
						var dict = new Dictionary<string, object>();
						dict.Add("location_code", Model.LocationCode);
						dict.Add("language_code", Model.LanguageCode);
						dict.Add("target", Model.Domain);
						dict.Add("order_by", new string[] { Model.Sort });
						dict.Add("limit", Model.PageCursor.NextTake);
						dict.Add("offset", Model.PageCursor.NextSkip);

						if(!string.IsNullOrEmpty(Model.Filter))
						{
							var deserialized = JsonConvert.DeserializeObject(Model.Filter);
							dict.Add("filters", deserialized);
						}

						var postData = new List<object>();
            postData.Add(dict);
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[0].items[*]">
        <JsonPath Expr="page_address" Id="Page" Title="Page" Converter="String"/>
        <JsonPath Expr="metrics.organic.count" Id="OrganicCount" Title="Organic Count" Converter="Long"/>
        <JsonPath Expr="metrics.organic.etv" Id="OrganicETV" Title="Organic ETV" Converter="Double"/>
        <JsonPath Expr="metrics.organic.estimated_paid_traffic_cost" Id="OrganicPaidTrafficCost" Title="Organic Paid Traffic Cost" Converter="Double"/>
        <JsonPath Expr="metrics.organic.impressions_etv" Id="OrganicImpressionsETV" Title="Organic Impressions ETV" Converter="Double"/>
        <JsonPath Expr="metrics.paid.count" Id="PaidCount" Title="Paid Count" Converter="Long"/>
        <JsonPath Expr="metrics.paid.etv" Id="PaidETV" Title="Paid ETV" Converter="Double"/>
        <JsonPath Expr="metrics.paid.estimated_paid_traffic_cost" Id="PaidPaidTrafficCost" Title="Paid Paid Traffic Cost" Converter="Double"/>
        <JsonPath Expr="metrics.paid.impressions_etv" Id="PaidImpressionsETV" Title="Paid Impressions ETV" Converter="Double"/>
        <JsonPath Expr="metrics.organic.pos_1" Id="OrganicPos1" Title="Organic Position 1" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_2_3" Id="OrganicPos23" Title="Organic Position 2-3" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_4_10" Id="OrganicPos410" Title="Organic Position 4-10" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_11_20" Id="OrganicPos1120" Title="Organic Position 11-20" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_21_30" Id="OrganicPos2130" Title="Organic Position 21-30" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_31_40" Id="OrganicPos3140" Title="Organic Position 31-40" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_41_50" Id="OrganicPos4150" Title="Organic Position 41-50" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_51_60" Id="OrganicPos5160" Title="Organic Position 51-60" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_61_70" Id="OrganicPos6170" Title="Organic Position 61-70" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_71_80" Id="OrganicPos7180" Title="Organic Position 71-80" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_81_90" Id="OrganicPos8190" Title="Organic Position 81-90" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_1" Id="PaidPos1" Title="Paid Position 1" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_2_3" Id="PaidPos23" Title="Paid Position 2-3" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_4_10" Id="PaidPos410" Title="Paid Position 4-10" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_11_20" Id="PaidPos1120" Title="Paid Position 11-20" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_21_30" Id="PaidPos2130" Title="Paid Position 21-30" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_31_40" Id="PaidPos3140" Title="Paid Position 31-40" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_41_50" Id="PaidPos4150" Title="Paid Position 41-50" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_51_60" Id="PaidPos5160" Title="Paid Position 51-60" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_61_70" Id="PaidPos6170" Title="Paid Position 61-70" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_71_80" Id="PaidPos7180" Title="Paid Position 71-80" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_81_90" Id="PaidPos8190" Title="Paid Position 81-90" Converter="Long"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Subdomains" Title="Subdomains" Group="Labs RESEARCH" HelpUrl="https://docs.dataforseo.com/v3/dataforseo_labs/subdomains/live/?php" HelpText="Provides you with a list of subdomains of the specified domain, along with the ranking distribution across organic and paid search.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="LabLocations"/>
			<Text Id="LanguageCode" Title="Language Code" Required="true" Debug.DefaultValue="sv" Select.Connector="LabLanguages"/>
			<Text Id="Domain" Title="Domain" Debug.DefaultValue="microsoft.com" Required="true"/>
			<Text Id="Filter" Title="Filter" HelpText="Click this icon to see example filters, ie: [&quot;metrics.paid.count&quot;,&quot;&gt;&quot;,0]" HelpUrl="https://docs.dataforseo.com/v3/dataforseo_labs/subdomains/live/?php"/>
			<Select Id="Sort" Title="Sort results by">
        <DataSource>
          <Item Id="metrics.organic.count,desc" Title="Count Organic Desc"/>
          <Item Id="metrics.organic.count,asc" Title="Count Organic Asc"/>
          <Item Id="metrics.paid.count,desc" Title="Count Paid Desc"/>
          <Item Id="metrics.paid.count,asc" Title="Count Paid Asc"/>
          <Item Id="metrics.organic.etv,desc" Title="ETV Organic Desc"/>
          <Item Id="metrics.organic.etv,asc" Title="ETV Organic Asc"/>
          <Item Id="metrics.paid.etv,desc" Title="ETV Paid Desc"/>
          <Item Id="metrics.paid.organic_et,asc" Title="ETV Paid Asc"/>
          <Item Id="metrics.organic.estimated_paid_traffic_cost,desc" Title="Paid Traffic Cost Organic Desc"/>
          <Item Id="metrics.organic.estimated_paid_traffic_cost,asc" Title="Paid Traffic Cost Organic Asc"/>
          <Item Id="metrics.paid.estimated_paid_traffic_cost,desc" Title="Paid Traffic Cost Paid Desc"/>
          <Item Id="metrics.paid.estimated_paid_traffic_cost,asc" Title="Paid Traffic Cost Paid Asc"/>
          <Item Id="metrics.organic.impressions_etv,desc" Title="Impressions ETV Organic Desc"/>
          <Item Id="metrics.organic.impressions_etv,asc" Title="Impressions ETV Organic Asc"/>
          <Item Id="metrics.paid.impressions_etv,desc" Title="Impressions ETV Paid Desc"/>
          <Item Id="metrics.paid.impressions_etv,asc" Title="Impressions ETV Paid Asc"/>
        </DataSource>
      </Select>
		</Parameters>
		<Paging PageSize="100" EvenPages="true"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/dataforseo_labs/subdomains/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
						var dict = new Dictionary<string, object>();
						dict.Add("location_code", Model.LocationCode);
						dict.Add("language_code", Model.LanguageCode);
						dict.Add("target", Model.Domain);
						dict.Add("order_by", new string[] { Model.Sort });
						dict.Add("limit", Model.PageCursor.NextTake);
						dict.Add("offset", Model.PageCursor.NextSkip);

						if(!string.IsNullOrEmpty(Model.Filter))
						{
							var deserialized = JsonConvert.DeserializeObject(Model.Filter);
							dict.Add("filters", deserialized);
						}

						var postData = new List<object>();
            postData.Add(dict);
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[0].items[*]">
        <JsonPath Expr="subdomain" Id="Subdomain" Title="Subdomain" Converter="String"/>
        <JsonPath Expr="metrics.organic.count" Id="OrganicCount" Title="Organic Count" Converter="Long"/>
        <JsonPath Expr="metrics.organic.etv" Id="OrganicETV" Title="Organic ETV" Converter="Double"/>
        <JsonPath Expr="metrics.organic.estimated_paid_traffic_cost" Id="OrganicPaidTrafficCost" Title="Organic Paid Traffic Cost" Converter="Double"/>
        <JsonPath Expr="metrics.organic.impressions_etv" Id="OrganicImpressionsETV" Title="Organic Impressions ETV" Converter="Double"/>
        <JsonPath Expr="metrics.paid.count" Id="PaidCount" Title="Paid Count" Converter="Long"/>
        <JsonPath Expr="metrics.paid.etv" Id="PaidETV" Title="Paid ETV" Converter="Double"/>
        <JsonPath Expr="metrics.paid.estimated_paid_traffic_cost" Id="PaidPaidTrafficCost" Title="Paid Paid Traffic Cost" Converter="Double"/>
        <JsonPath Expr="metrics.paid.impressions_etv" Id="PaidImpressionsETV" Title="Paid Impressions ETV" Converter="Double"/>
        <JsonPath Expr="metrics.organic.pos_1" Id="OrganicPos1" Title="Organic Position 1" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_2_3" Id="OrganicPos23" Title="Organic Position 2-3" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_4_10" Id="OrganicPos410" Title="Organic Position 4-10" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_11_20" Id="OrganicPos1120" Title="Organic Position 11-20" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_21_30" Id="OrganicPos2130" Title="Organic Position 21-30" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_31_40" Id="OrganicPos3140" Title="Organic Position 31-40" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_41_50" Id="OrganicPos4150" Title="Organic Position 41-50" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_51_60" Id="OrganicPos5160" Title="Organic Position 51-60" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_61_70" Id="OrganicPos6170" Title="Organic Position 61-70" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_71_80" Id="OrganicPos7180" Title="Organic Position 71-80" Converter="Long"/>
        <JsonPath Expr="metrics.organic.pos_81_90" Id="OrganicPos8190" Title="Organic Position 81-90" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_1" Id="PaidPos1" Title="Paid Position 1" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_2_3" Id="PaidPos23" Title="Paid Position 2-3" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_4_10" Id="PaidPos410" Title="Paid Position 4-10" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_11_20" Id="PaidPos1120" Title="Paid Position 11-20" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_21_30" Id="PaidPos2130" Title="Paid Position 21-30" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_31_40" Id="PaidPos3140" Title="Paid Position 31-40" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_41_50" Id="PaidPos4150" Title="Paid Position 41-50" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_51_60" Id="PaidPos5160" Title="Paid Position 51-60" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_61_70" Id="PaidPos6170" Title="Paid Position 61-70" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_71_80" Id="PaidPos7180" Title="Paid Position 71-80" Converter="Long"/>
        <JsonPath Expr="metrics.paid.pos_81_90" Id="PaidPos8190" Title="Paid Position 81-90" Converter="Long"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="KeywordIdeas" Title="Keyword Ideas" Group="Labs RESEARCH" HelpUrl="https://docs.dataforseo.com/v3/dataforseo_labs/keyword_ideas/live/?csharp" HelpText="Provides search terms that are relevant to the product or service categories of the specified keywords.">
		<Parameters>
			<Text Id="LocationCode" Title="Location Code" Required="true" Syntax="^\d+$" Debug.DefaultValue="2752" Select.Connector="LabLocations"/>
			<Text Id="LanguageCode" Title="Language Code" Required="true" Debug.DefaultValue="sv" Select.Connector="LabLanguages"/>
			<Text Id="Keyword" Title="Keyword" Debug.DefaultValue="trump" Required="true"/>
			<Text Id="Filter" Title="Filter" HelpText="Click this icon to see example filters, ie: [&quot;keyword_info.search_volume&quot;,&quot;>&quot;,0]" HelpUrl="https://docs.dataforseo.com/v3/dataforseo_labs/keyword_suggestions/live/?csharp"/>
			<Checkbox Id="Closely" Title="Closely Variants" HelpText="If set to true the results will be based on the phrase-match search algorithm, otherwise based on the broad-match search algorithm."/>
			<Select Id="Sort" Title="Sort results by">
        <DataSource>
          <Item Id="keyword_info.search_volume,desc" Title="Volume Desc"/>
          <Item Id="keyword_info.search_volume,asc" Title="Volume Asc"/>
          <Item Id="keyword_info.competition,desc" Title="Competition Desc"/>
          <Item Id="keyword_info.competition,asc" Title="Competition Asc"/>
          <Item Id="keyword_info.cpc,desc" Title="CPC Desc"/>
          <Item Id="keyword_info.cpc,asc" Title="CPC Asc"/>
        </DataSource>
      </Select>
		</Parameters>
		<Paging PageSize="100" EvenPages="true"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/dataforseo_labs/keyword_ideas/live
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[
					@{
						var dict = new Dictionary<string, object>();
						dict.Add("location_code", Model.LocationCode);
						dict.Add("language_code", Model.LanguageCode);
						dict.Add("keywords", new string[] { Model.Keyword });
						dict.Add("order_by", new string[] { Model.Sort });
						dict.Add("limit", Model.PageCursor.NextTake);
						dict.Add("offset", Model.PageCursor.NextSkip);
						dict.Add("closely_variants", Model.Closely);

						if(!string.IsNullOrEmpty(Model.Filter))
						{
							var deserialized = JsonConvert.DeserializeObject(Model.Filter);
							dict.Add("filters", deserialized);
						}

						var postData = new List<object>();
            postData.Add(dict);
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[0].items[*]">
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String"/>
        <JsonPath Expr="keyword_info.competition" Id="Competition" Title="Competition" Converter="Double"/>
        <JsonPath Expr="keyword_info.cpc" Id="CPC" Title="CPC" Converter="Double"/>
        <JsonPath Expr="keyword_info.search_volume" Id="Volume" Title="Volume" Converter="Double"/>
        <JsonPath Expr="impressions_info.ad_position_min" Id="AdPositionMin" Title="Ad Position Min" Converter="Auto"/>
        <JsonPath Expr="impressions_info.ad_position_max" Id="AdPositionMax" Title="Ad Position Max" Converter="Auto"/>
        <JsonPath Expr="impressions_info.ad_position_average" Id="AdPositionAvg" Title="Ad Position Avg" Converter="Auto"/>
        <JsonPath Expr="impressions_info.cpc_min" Id="CPCMin" Title="CPC Min" Converter="Auto"/>
        <JsonPath Expr="impressions_info.cpc_max" Id="CPCMax" Title="CPC Max" Converter="Auto"/>
        <JsonPath Expr="impressions_info.cpc_average" Id="CPCAvg" Title="CPC Avg" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_impressions_min" Id="DailyImpressionsMin" Title="Daily Impressions Min" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_impressions_max" Id="DailyImpressionsMax" Title="Daily Impressions Max" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_impressions_average" Id="DailyImpressionsAvg" Title="Daily Impressions Avg" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_clicks_min" Id="DailyClicksMin" Title="Daily Clicks Min" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_clicks_max" Id="DailyClicksMax" Title="Daily Clicks Max" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_clicks_average" Id="DailyClicksAvg" Title="Daily Clicks Avg" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_cost_min" Id="DailyCostMin" Title="Daily Cost Min" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_cost_max" Id="DailyCostMax" Title="Daily Cost Max" Converter="Auto"/>
        <JsonPath Expr="impressions_info.daily_cost_average" Id="DailyCostAvg" Title="Daily Cost Avg" Converter="Auto"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="OnPageInit" HelpUrl="https://docs.dataforseo.com/v3/on_page/task_post/?php" Hidden="true">
		<Parameters>
      <Text Id="Target" Debug.DefaultValue="seotoolsforexcel.com"/>
      <Text Id="StartUrl"/>
      <Text Id="UserAgent"/>
      <Text Id="Pages" Debug.DefaultValue="10"/>
      <Text Id="Depth" Debug.DefaultValue="1"/>
      <Text Id="Delay" Debug.DefaultValue="100"/>
      <Text Id="AllowSubdomains"/>
      <Text Id="RespectSitemap"/>
		</Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/on_page/task_post
        ]]>
      </Fetch.Url>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
				<Resource Id="Headers"/>
        <RequestBody>
          <![CDATA[

					@{
						var dict = new Dictionary<string, object>();
						dict.Add("target", Utils.UrlProperty(Model.Target).Domain);
						dict.Add("max_crawl_pages", Model.Pages);
						dict.Add("depth", Model.Depth);
						dict.Add("crawl_delay", Model.Delay);
						dict.Add("allow_subdomains", Model.AllowSubdomains.Equals("True"));
						dict.Add("respect_sitemap", Model.RespectSitemap.Equals("True"));

						if(!string.IsNullOrEmpty(Model.StartUrl)) {
							dict.Add("start_url", Model.StartUrl);
						}

						if(!string.IsNullOrEmpty(Model.UserAgent)) {
							dict.Add("custom_user_agent", Model.UserAgent);
						}

						var postData = new List<object>();
            postData.Add(dict);
					}
					@JsonConvert.SerializeObject(postData)
					]]>
        </RequestBody>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="tasks[0].id" Id="TaskId"/>
    </Parse>
  </RestConnector>

  <RestConnector Id="OnPageSummary" Title="On-Page Summary" HelpUrl="https://docs.dataforseo.com/v3/on_page/summary/?php" Group="On-Page" HelpText="Get the overall information on a website as well as drill down into exact on-page issues of a website that has been scanned.">
		<Parameters>
			<Text Id="Target" Title="Target Domain" Required="true" Debug.DefaultValue="seotoolsforexcel.com"/>
			<Text Id="StartUrl" Title="Custom Start URL" HelpText="The first url to crawl. You should specify the absolute URL if you want to crawl a single page, specify its URL in this field and set the 'Max Pages' parameter to 1"/>
			<Text Id="UserAgent" Title="Custom User-Agent" HelpText="custom user agent for crawling a website, example: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36"/>
			<Number Id="Pages" Title="Max Number of Pages" DefaultValue="10" Debug.DefaultValue="3" Minimum="1" HelpText="the number of pages to crawl on the specified domain"/>
			<Number Id="Depth" HelpText="the linking depth of the pages to crawl, for example, home page is level 0, pages that have links from the home page are level 1, etc"/>
			<Number Id="Delay" DefaultValue="100" HelpText="The custom delay in ms between crawler hits to the server"/>
			<Checkbox Id="AllowSubdomains" Title="Allow Subdomains" HelpText="Check if you want to crawl all subdomains of a target website"/>
			<Checkbox Id="RespectSitemap" Title="Respect Sitemap" DefaultValue="true" HelpText="Uncheck if you want to ignore the order of pages indicated in the primary sitemap when crawling"/>
    </Parameters>
    <Prepare>
      <Connector Id="OnPageInit" Parameters="Target,StartUrl,UserAgent,Pages,Depth,Delay,AllowSubdomains,RespectSitemap"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/on_page/summary/@(Model.TaskId)
        ]]>
      </Fetch.Url>
      <HttpSettings>
				<Resource Id="Headers"/>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.tasks[0].result[0].domain_info">
        <JsonPath Expr="name" Id="Domain"/>
        <JsonPath Expr="ssl_info.valid_certificate" Id="SSLValidCertificate" Title="SSL Valid Certificate"/>
        <JsonPath Expr="total_pages" Id="Pages" Converter="Int"/>
			</JsonPath>
      <JsonPath Expr="$.tasks[0].result[0].page_metrics">
        <JsonPath Expr="links_external" Id="LinksInternal" Title="Links Internal" Converter="Int"/>
        <JsonPath Expr="links_internal" Id="LinksExternal" Title="Links External" Converter="Int"/>
        <JsonPath Expr="duplicate_title" Id="DuplicateTitle" Title="Duplicate Title" Converter="Int"/>
        <JsonPath Expr="duplicate_description" Id="DuplicateDescription" Title="Duplicate Description" Converter="Int"/>
        <JsonPath Expr="duplicate_content" Id="DuplicateContent" Title="Duplicate Content" Converter="Int"/>
        <JsonPath Expr="broken_links" Id="BrokenLinks" Title="Broken Links" Converter="Int"/>
        <JsonPath Expr="broken_resources" Id="BrokenResources" Title="Broken Resources" Converter="Int"/>
				<JsonPath Expr="checks.canonical" Id="Canonical" Title="Canonical" Converter="Int"/>
				<JsonPath Expr="checks.duplicate_meta_tags" Id="DuplicateMetaTags" Title="Duplicate Meta Tags" Converter="Int"/>
				<JsonPath Expr="checks.no_description" Id="NoDescription" Title="No Description" Converter="Int"/>
				<JsonPath Expr="checks.frame" Id="Frame" Title="Frame" Converter="Int"/>
				<JsonPath Expr="checks.large_page_size" Id="LargePageSize" Title="Large Page Size" Converter="Int"/>
				<JsonPath Expr="checks.irrelevant_description" Id="IrrelevantDescription" Title="Irrelevant Description" Converter="Int"/>
				<JsonPath Expr="checks.irrelevant_meta_keywords" Id="IrrelevantMetaKeywords" Title="Irrelevant Meta Keywords" Converter="Int"/>
				<JsonPath Expr="checks.is_https" Id="IsHttps" Title="Is Https" Converter="Int"/>
				<JsonPath Expr="checks.is_http" Id="IsHttp" Title="Is Http" Converter="Int"/>
				<JsonPath Expr="checks.title_too_long" Id="TitleTooLong" Title="Title Too Long" Converter="Int"/>
				<JsonPath Expr="checks.low_content_rate" Id="LowContentRate" Title="Low Content Rate" Converter="Int"/>
				<JsonPath Expr="checks.small_page_size" Id="SmallPageSize" Title="Small Page Size" Converter="Int"/>
				<JsonPath Expr="checks.no_h1_tag" Id="NoH1Tag" Title="No H1 Tag" Converter="Int"/>
				<JsonPath Expr="checks.no_favicon" Id="NoFavicon" Title="No Favicon" Converter="Int"/>
				<JsonPath Expr="checks.no_image_alt" Id="NoImageAlt" Title="No Image Alt" Converter="Int"/>
				<JsonPath Expr="checks.no_image_title" Id="NoImageTitle" Title="No Image Title" Converter="Int"/>
				<JsonPath Expr="checks.seo_friendly_url" Id="SeoFriendlyUrl" Title="SEO Friendly URL" Converter="Int"/>
				<JsonPath Expr="checks.seo_friendly_url_characters_check" Id="SeoFriendlyUrlCharactersCheck" Title="SEO Friendly URL Characters Check" Converter="Int"/>
				<JsonPath Expr="checks.seo_friendly_url_dynamic_check" Id="SeoFriendlyUrlDynamicCheck" Title="SEO Friendly URL Dynamic Check" Converter="Int"/>
				<JsonPath Expr="checks.seo_friendly_url_keywords_check" Id="SeoFriendlyUrlKeywordsCheck" Title="SEO Friendly URL Keywords Check" Converter="Int"/>
				<JsonPath Expr="checks.seo_friendly_url_relative_length_check" Id="SeoFriendlyUrlRelativeLengthCheck" Title="SEO Friendly URL Relative Length Check" Converter="Int"/>
				<JsonPath Expr="checks.title_too_short" Id="TitleTooShort" Title="Title Too Short" Converter="Int"/>
				<JsonPath Expr="checks.no_content_encoding" Id="NoContentEncoding" Title="No Content Encoding" Converter="Int"/>
				<JsonPath Expr="checks.high_waiting_time" Id="HighWaitingTime" Title="High Waiting Time" Converter="Int"/>
				<JsonPath Expr="checks.high_loading_time" Id="HighLoadingTime" Title="High Loading Time" Converter="Int"/>
				<JsonPath Expr="checks.is_redirect" Id="IsRedirect" Title="Is Redirect" Converter="Int"/>
				<JsonPath Expr="checks.is_broken" Id="IsBroken" Title="Is Broken" Converter="Int"/>
				<JsonPath Expr="checks.is_www" Id="IsWww" Title="Is WWW" Converter="Int"/>
				<JsonPath Expr="checks.no_doctype" Id="NoDoctype" Title="No Doctype" Converter="Int"/>
				<JsonPath Expr="checks.no_encoding_meta_tag" Id="NoEncodingMetaTag" Title="No Encoding Meta Tag" Converter="Int"/>
				<JsonPath Expr="checks.high_content_rate" Id="HighContentRate" Title="High Content Rate" Converter="Int"/>
				<JsonPath Expr="checks.low_character_count" Id="LowCharacterCount" Title="Low Character Count" Converter="Int"/>
				<JsonPath Expr="checks.high_character_count" Id="HighCharacterCount" Title="High Character Count" Converter="Int"/>
				<JsonPath Expr="checks.low_readability_rate" Id="LowReadabilityRate" Title="Low Readability Rate" Converter="Int"/>
				<JsonPath Expr="checks.irrelevant_title" Id="IrrelevantTitle" Title="Irrelevant Title" Converter="Int"/>
				<JsonPath Expr="checks.deprecated_html_tags" Id="DeprecatedHtmlTags" Title="Deprecated Html Tags" Converter="Int"/>
				<JsonPath Expr="checks.duplicate_title_tag" Id="DuplicateTitleTag" Title="Duplicate Title Tag" Converter="Int"/>
				<JsonPath Expr="checks.no_title" Id="NoTitle" Title="No Title" Converter="Int"/>
				<JsonPath Expr="checks.flash" Id="Flash" Title="Flash" Converter="Int"/>
				<JsonPath Expr="checks.lorem_ipsum" Id="LoremIpsum" Title="Lorem Ipsum" Converter="Int"/>
      </JsonPath>
    </Parse>
    <Fail>
			<JsonPath Expr="$.tasks[0].status_code" Fail.If="IsEqual" Fail.ComparedTo="40602" Fail.Action="Retry" Fail.RetryAfter="5000" Fail.RetryTimes="100"/>
			<JsonPath Expr="$.tasks[0].result[0].crawl_progress" Fail.If="IsEqual" Fail.ComparedTo="in_progress" Fail.Action="Retry" Fail.RetryAfter="5000" Fail.RetryTimes="100"/>
		</Fail>
  </RestConnector>

	<RestConnector Id="AvailableCredits" Title="Available API Credits" HelpUrl="https://docs.dataforseo.com/#get-pages">
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.dataforseo.com/v3/appendix/user_data
        ]]>
      </Fetch.Url>
      <HttpSettings>
				<Resource Id="Headers"/>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Id="Balance" Expr="$.tasks[0].result[*].money.balance" Converter="Double"/>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RazorFunctions>
    <![CDATA[
    string CreateBasicAuth() {
      return Convert.ToBase64String(ASCIIEncoding.ASCII.GetBytes(Model.Email + ":" + Model.Key));
    }

    string[] CreateArr(int limit){
      return ((string)Model.Keyword).Trim().Split('\n').Select(e => e.Trim()).Where(e => !string.IsNullOrEmpty(e)).Take(limit).ToArray();
    }
    ]]>
  </RazorFunctions>

</Suite>