<?xml version="1.0" encoding="utf-8" ?>
<Suite Title="Siteimprove" Id="Siteimprove" Category="SEO" RequireVersion="9.5.4" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Siteimprove.xml" HelpUrl="http://seotoolsforexcel.com/siteimprove/" HelpText="Documentation">

  <Author Name="Victor Sandberg" Url="http://community.seotoolsforexcel.com/users/diskborste/activity" />

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/siteimprove/">
    <Text Id="Email" Title="Email" Required="true" HelpUrl="http://seotoolsforexcel.com/siteimprove/"/>
    <Text Id="ApiKey" Title="API Key" Required="true" HelpUrl="http://seotoolsforexcel.com/siteimprove/"/>
  </Settings>

  <Resources>
    <Resource Id="HttpSettings">
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
					<Header Name='X-Siteimprove-Api-Caller'>SeoToolsForExcel</Header>
        </RequestHeaders>
      </HttpSettings>
    </Resource>
    <Resource Id="Fail">
			<Fail>
				<Try Fail.If="EmptyResponse" Fail.Action="Message" Fail.Message="Something went wrong. Check API Key."/>
				<JsonPath Expr="message"/>
			</Fail>
    </Resource>
  </Resources>

  <RestConnector Id="Sites" HelpUrl="https://api.siteimprove.com/v2/documentation#!/General/get_sites" Hidden="true">
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites?page_size=500
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
        <JsonPath Expr="id" Id="Id" Title="Site Id"/>
        <JsonPath Expr="site_name" Id="Site" Title="Site Name"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="SiteDCI" Title="DCI Scores" Group="General Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/General/get_sites_site_id_dci_overview" HelpText="Get all DCI scores associated with this site.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/dci/overview
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="total" Id="Total" Title="Total" Converter="Double"/>
			<JsonPath Expr="accessibility.errorpages" Id="Errorpages" Title="Errorpages" Converter="Double"/>
			<JsonPath Expr="accessibility.errors" Id="Errors" Title="Errors" Converter="Double"/>
			<JsonPath Expr="accessibility.total" Id="TotalPages" Title="Total Pages" Converter="Double"/>
			<JsonPath Expr="accessibility.warnings" Id="Warnings" Title="Warnings" Converter="Double"/>
			<JsonPath Expr="qa.content" Id="QAContent" Title="QA - Content" Converter="Double"/>
			<JsonPath Expr="qa.freshness" Id="QAFreshness" Title="QA - Freshness" Converter="Double"/>
			<JsonPath Expr="qa.security" Id="QASecurity" Title="QA - Security" Converter="Double"/>
			<JsonPath Expr="qa.total" Id="QATotal" Title="QA - Total" Converter="Double"/>
			<JsonPath Expr="qa.ux" Id="QAUx" Title="QA - UX" Converter="Double"/>
			<JsonPath Expr="seo.content" Id="SeoContent" Title="Seo - Content" Converter="Double"/>
			<JsonPath Expr="seo.mobile" Id="SeoMobile" Title="Seo - Mobile" Converter="Double"/>
			<JsonPath Expr="seo.technical" Id="SeoTechnical" Title="Seo - Technical" Converter="Double"/>
			<JsonPath Expr="seo.total" Id="SeoTotal" Title="Seo - Total" Converter="Double"/>
			<JsonPath Expr="seo.ux" Id="SeoUx" Title="Seo - UX" Converter="Double"/>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="PageStatusUrl" Title="Page Status by URL" Group="General Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Content/get_sites_site_id_content_check_page" HelpText="Check status for a page specified by Url.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <Text Id="Url" Title="URL" Required="true"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/content/check/page?url=@(Utils.UrlEncode(Model.Url))
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
			<JsonPath Expr="title" Id="Title" Title="Title" Converter="String"/>
			<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
			<JsonPath Expr="first_seen" Id="FirstSeen" Title="First Seen" Converter="String"/>
			<JsonPath Expr="last_seen" Id="LastSeen" Title="Last Seen" Converter="String"/>
			<JsonPath Expr="check_allowed" Id="CheckAllowed" Title="Check Allowed" Converter="Bool"/>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="PageStatusId" Title="Page Status by Id" Group="Content Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Content/get_sites_site_id_content_check_page_page_id" HelpText="Check status for a page via page id.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <Text Id="PageId" Title="Page Id" Required="true" Syntax="^\d+$"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/content/check/page/@(Model.PageId)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
			<JsonPath Expr="title" Id="Title" Title="Title" Converter="String"/>
			<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
			<JsonPath Expr="first_seen" Id="FirstSeen" Title="First Seen" Converter="DateTime"/>
			<JsonPath Expr="last_seen" Id="LastSeen" Title="Last Seen" Converter="DateTime"/>
			<JsonPath Expr="check_allowed" Id="CheckAllowed" Title="Check Allowed" Converter="Bool"/>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="Pages" Title="List Pages" Group="Content Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Content/get_sites_site_id_content_pages" HelpText="Get list of pages for a site.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="461076" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <Text Id="Url" Title="Filter by URL" Required="false"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/content/pages
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@(!string.IsNullOrEmpty(Model.Url) ? "&url=" + Utils.UrlEncode(Model.Url) : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
        <JsonPath Expr="title" Id="Title" Title="Title" Converter="String"/>
        <JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

 <RestConnector Id="PageDetails" Title="Page Details" Group="Content Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Content/get_sites_site_id_content_pages_page_id" HelpText="Get page details for a page.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <Text Id="PageId" Title="Page Id" Required="true" Syntax="^\d+$"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/content/pages/@(Model.PageId)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
			<JsonPath Expr="title" Id="Title" Title="Title" Converter="String"/>
			<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
			<JsonPath Expr="size_bytes" Id="Bytes" Title="Bytes" Converter="Long"/>
			<JsonPath Expr="$.summary.page.last_seen" Id="LastSeen" Title="LastSeen" Converter="Auto"/>
			<JsonPath Expr="$.summary.page.check_allowed" Id="CheckAllowed" Title="Check Allowed" Converter="Bool"/>
			<JsonPath Expr="$.summary.seo.errors" Id="Errors" Title="Errors" Converter="Long"/>
			<JsonPath Expr="$.summary.seo.needs_review" Id="NeedsReview" Title="Needs Review" Converter="Long"/>
			<JsonPath Expr="$.summary.seo.warnings" Id="Warnings" Title="Warnings" Converter="Long"/>
			<JsonPath Expr="$.summary.policy.matching_policies" Id="MatchingPolicies" Title="Matching Policies" Converter="Long"/>
			<JsonPath Expr="$.summary.policy.high_priority_policies" Id="HighPriorityPolicies" Title="High Priority Policies" Converter="Long"/>
			<JsonPath Expr="$.summary.policy.high_priority_matching_policies" Id="HighPriorityMatchingPolicies" Title="High Priority Matching Policies" Converter="Long"/>
			<JsonPath Expr="$.summary.policy.high_priority_pending_checks" Id="HighPriorityPendingChecks" Title="High Priority Pending Checks" Converter="Long"/>
			<JsonPath Expr="$.summary.quality_assurance.misspellings" Id="Misspellings" Title="Misspellings" Converter="Long"/>
			<JsonPath Expr="$.summary.quality_assurance.potential_misspellings" Id="PotentialMisspellings" Title="Potential Misspellings" Converter="Long"/>
			<JsonPath Expr="$.summary.accessibility.a_errors" Id="AErrors" Title="A_Errors" Converter="Long"/>
			<JsonPath Expr="$.summary.accessibility.a_issues" Id="AIssues" Title="A_Issues" Converter="Long"/>
			<JsonPath Expr="$.summary.accessibility.a_warnings" Id="AWarnings" Title="A_Warnings" Converter="Long"/>
			<JsonPath Expr="$.summary.accessibility.aa_errors" Id="AAErrors" Title="AA_Errors" Converter="Long"/>
			<JsonPath Expr="$.summary.accessibility.aa_issues" Id="AAIssues" Title="AA_Issues" Converter="Long"/>
			<JsonPath Expr="$.summary.accessibility.aa_warnings" Id="AAWarnings" Title="AA_Warnings" Converter="Long"/>
			<JsonPath Expr="$.summary.accessibility.aaa_errors" Id="AAAErrors" Title="AAA_Errors" Converter="Long"/>
			<JsonPath Expr="$.summary.accessibility.aaa_issues" Id="AAAIssues" Title="AAA_Issues" Converter="Long"/>
			<JsonPath Expr="$.summary.accessibility.aaa_warnings" Id="AAAWarnings" Title="AAA_Warnings" Converter="Long"/>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="SeoIssues" Title="SEO Issues" Group="SEO Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/SEO/get_sites_site_id_seo_issues" HelpText="Get all SEO issues on your website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
			<Radio Id="Responsibility" Title="Responsibility" DefaultValue="all" Required="false">
        <DataSource>
          <Item Id="all" Title="All Types"/>
          <Item Id="editorial" Title="Editorial"/>
          <Item Id="technical" Title="Technical"/>
        </DataSource>
      </Radio>
			<Radio Id="Severity" Title="Severity" DefaultValue="all" Required="false">
        <DataSource>
          <Item Id="all" Title="All Types"/>
          <Item Id="review" Title="Review"/>
          <Item Id="warning" Title="Warning"/>
          <Item Id="error" Title="Error"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/seo/issues
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@(Model.Responsibility != "all" ? "&responsibility=" + Model.Responsibility : "")
					@(Model.Severity != "all" ? "&severity=" + Model.Severity : "")
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
        <JsonPath Expr="issue_type" Id="Issue" Title="Issue" Converter="String"/>
        <JsonPath Expr="affected_pages" Id="AffectedPages" Title="Affected Pages" Converter="Long"/>
        <JsonPath Expr="role" Id="Role" Title="Role" Converter="String"/>
        <JsonPath Expr="severity" Id="Severity" Title="Severity" Converter="String"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

 <RestConnector Id="SeoPageIssues" Title="Page Issues" Group="SEO Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/SEO/get_sites_site_id_seo_pages_page_id_issues" HelpText="Get SEO issues for a specific page.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <Text Id="PageId" Title="Page Id" Required="true" Syntax="^\d+$"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/seo/pages/@(Model.PageId)/issues
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
        <JsonPath Expr="issue_type" Id="Issue" Title="Issue" Converter="String"/>
        <JsonPath Expr="severity" Id="Severity" Title="Severity" Converter="String"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="SeoPages" Title="List SEO-checked Pages" Group="SEO Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/SEO/get_sites_site_id_seo_pages" HelpText="Get all pages that are being checked for SEO issues.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/seo/pages
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String"/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
        <JsonPath Expr="csv(keywords)" Id="Keywords" Title="Keywords"/>
				<JsonPath Expr="issues" Id="Issues" Title="Issues" Converter="Long"/>
				<JsonPath Expr="page_level" Id="PageLevel" Title="Page Level" Converter="Long"/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long" DefaultValue=""/>
        <JsonPath Expr="_siteimprove.page_report.href" Id="PageReport" Title="Page Report" Converter="String"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsVisitDepth" Title="Visit Depth" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_behavior_visit_depth" HelpText="Get the visit depth. Depth relates to the number of page views for each visit.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/behavior/visit_depth?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="page_views_per_visit" Id="ViewsPerVisit" Title="Views Per Visit" Converter="Long"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsVisitDepthHistory" Title="Visit Depth History" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_behavior_visit_depth_history" HelpText="A series of historical data points showing the average amount of page views.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/behavior/visit_depth/history
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="timestamp" Id="Timestamp" Title="Timestamp" Converter="DateTime"/>
				<JsonPath Expr="page_views_average" Id="PageViewsAverage" Title="Page Views Average" Converter="Double"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsActivityByHour" Title="Activity by Hour" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_behavior_visits_by_hour" HelpText="Get the distribution of visits and page views over hours of the day.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/behavior/visits_by_hour?
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="hour_of_day" Id="Hour" Title="Hour" Converter="Long"/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long"/>
				<JsonPath Expr="average_page_views_per_visit" Id="AveragePageViews" Title="Average Page Views" Converter="Double"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsActivityByMonthDay" Title="Activity by Monthday" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_behavior_visits_by_monthday" HelpText="Get the distribution of visits and page views over day of the month.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/behavior/visits_by_monthday?
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="day_of_month" Id="Day" Title="Monthday" Converter="Long"/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long"/>
				<JsonPath Expr="average_page_views_per_visit" Id="AveragePageViews" Title="Average Page Views" Converter="Double"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsActivityByWeekDay" Title="Activity by Weekday" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_behavior_visits_by_weekday" HelpText="Get the distribution of visits and page views over weekday.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/behavior/visits_by_weekday?
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="day_of_week" Id="Day" Title="Weekday" Converter="Long"/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long"/>
				<JsonPath Expr="average_page_views_per_visit" Id="AveragePageViews" Title="Average Page Views" Converter="Double"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsVisitLength" Title="Visit Length" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_behavior_visit_length" HelpText="Get the length of a visit. Length relates to the duration (in minutes) of each visit.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/behavior/visit_length
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="visit_duration_in_minutes" Id="VisitDuration" Title="Visit Duration" Converter="Long"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsVisitLengthHistory" Title="Visit Length History" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_behavior_visit_length_history" HelpText="A series of historical data points showing the average visit length. Length relates to the duration (in minutes) of each visit.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/behavior/visit_length/history
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="timestamp" Id="Timestamp" Title="Timestamp" Converter="DateTime"/>
				<JsonPath Expr="visit_duration_average_in_minutes" Id="VisitDurationAverage" Title="Visit Duration Average" Converter="Double"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsAllPages" Title="All Pages" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_all_pages" HelpText="Get all pages identified on your site.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/all_pages
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue=""/>
				<JsonPath Expr="average_page_views_per_visit" Id="AveragePageViews" Title="Average Page Views" Converter="Double"/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double"/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsEntryPages" Title="Entry Pages" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_entry_pages" HelpText="An entry page is the first page a visitor sees when they enter the website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/entry_pages
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double"/>
				<JsonPath Expr="entries" Id="Entries" Title="Entries" Converter="Long"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsExitPages" Title="Exit Pages" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_exit_pages" HelpText="An exit page is the last page a visitor sees before they leave the website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/exit_pages
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double"/>
				<JsonPath Expr="exits" Id="Exits" Title="Exits" Converter="Long"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsLeastPopularPages" Title="Least Popular Pages" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_least_popular_pages" HelpText="Get the least popular pages among the top 1000 pages with the most page views.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/least_popular_pages
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue=""/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
				<JsonPath Expr="last_visited" Id="LastVisited" Title="Last Visited" Converter="DateTime"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsMostPopularPages" Title="Most Popular Pages" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_most_popular_pages" HelpText="Get the least most pages among the top 1000 pages with the most page views.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/most_popular_pages
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double"/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
				<JsonPath Expr="last_visited" Id="LastVisited" Title="Last Visited" Converter="DateTime"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsNavigationDepth" Title="Navigation Depth" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_navigation_depth" HelpText="Get the average number of clicks (pages visited) to get to a certain page.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/navigation_depth
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue=""/>
				<JsonPath Expr="average_clicks" Id="AverageClicks" Title="Average Clicks" Converter="Double"/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsOutboundLinks" Title="Outbound Links" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_outbound_links" HelpText="Get links to external domains, that have been used to leave your site.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/outbound_links
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue=""/>
				<JsonPath Expr="pages" Id="Pages" Title="Pages" Converter="Long"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsOutboundLinkHistory" Title="Outbound Link History" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_outbound_links_outbound_link_id_history" HelpText="A series of historical data points showing the amount of visits for a specific outbound link.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <Text Id="OutboundId" Title="Outbound Link Id" Debug.DefaultValue="293077723" Syntax="^\d+$" Required="true"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/outbound_links/@(Model.OutboundId)/history
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="timestamp" Id="Timestamp" Title="Timestamp" Converter="DateTime"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsPageLoadTime" Title="Pages Load Time" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#/" HelpText="Get the average amount of time (in seconds) it takes a page to load.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/page_load_time
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue=""/>
				<JsonPath Expr="average_page_load_time" Id="AverageLoadTime" Title="Average Load Time" Converter="Auto" DefaultValue=""/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsBounceRates" Title="Bounce Rates" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_entries_exits_bounce_rates" HelpText="List of pages with bounces and bounce rate.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/bounce_rates
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double"/>
				<JsonPath Expr="bounces" Id="Bounces" Title="Bounces" Converter="Long"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsEntriesExits" Title="Entries and Exits" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_entries_exits_entry_exit_rates" HelpText="List the amount of entries and exits registered for your pages.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/entries_exits/entry_exit_rates
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double"/>
				<JsonPath Expr="bounces" Id="Bounces" Title="Bounces" Converter="Long"/>
				<JsonPath Expr="entry_rate" Id="EntryRate" Title="Entry Rate" Converter="Double"/>
				<JsonPath Expr="entries" Id="Entries" Title="Entries" Converter="Long"/>
				<JsonPath Expr="exit_rate" Id="ExitRate" Title="Exit Rate" Converter="Double"/>
				<JsonPath Expr="exits" Id="Exits" Title="Exits" Converter="Long"/>
				<JsonPath Expr="last_outbound_link_clicks" Id="LastOutboundLinkClicks" Title="Last Outbound Link Clicks" Converter="Long"/>
				<JsonPath Expr="last_outbound_link_rate" Id="LastOutboundClickRate" Title="Last Outbound Click Rate" Converter="Double"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsPageLastOutboundLinks" Title="Page Last Outbound Links" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_entries_exits_entry_exit_rates_page_id_last_outbound_links" HelpText="The last outbound links and their amount of clicks for a specific exit page.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <Text Id="PageId" Title="Page Id" Debug.DefaultValue="293045864" Required="true" Syntax="^\d+$"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/entries_exits/entry_exit_rates/@(Model.PageId)/last_outbound_links
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue=""/>
				<JsonPath Expr="clicks" Id="Clicks" Title="Clicks" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsOverviewSummary" Title="Overview Summary" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_overview_summary" HelpText="Get a summary of the most common statistics for your site.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/overview/summary
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double"/>
			<JsonPath Expr="new_visitors" Id="NewVisitors" Title="New Visitors" Converter="Long"/>
			<JsonPath Expr="page_views" Id="PgeViews" Title="PageViews" Converter="Long"/>
			<JsonPath Expr="returning_visitors" Id="ReturningVisitors" Title="Returning Visitors" Converter="Long"/>
			<JsonPath Expr="unique_visitors" Id="UniqueVisitors" Title="Unique Visitors" Converter="Long"/>
			<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsOverviewHistory" Title="Overview History" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_overview_history" HelpText="A series of historical data points showing the most common statistics for your site.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/overview/history
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="timestamp" Id="Timestamp" Title="Timestamp" Converter="DateTime"/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double"/>
				<JsonPath Expr="new_visitors" Id="NewVisitors" Title="New Visitors" Converter="Long"/>
				<JsonPath Expr="page_views" Id="PgeViews" Title="PageViews" Converter="Long"/>
				<JsonPath Expr="returning_visitors" Id="ReturningVisitors" Title="Returning Visitors" Converter="Long"/>
				<JsonPath Expr="unique_visitors" Id="UniqueVisitors" Title="Unique Visitors" Converter="Long"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsOnlineVisitors" Title="Online Visitors" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_overview_online_visitors" HelpText="Get the current online visitors.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/overview/online_visitors
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="city" Id="City" Title="City" Converter="String"/>
				<JsonPath Expr="region" Id="Region" Title="Region" Converter="String"/>
				<JsonPath Expr="country_name" Id="Country" Title="Country" Converter="String"/>
				<JsonPath Expr="organisation" Id="Organisation" Title="Organisation" Converter="String"/>
				<JsonPath Expr="page_views" Id="PageViews" Title="PageViews" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsDirectTrafficEntryPages" Title="Direct Traffic Entry Pages" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_traffic_sources_direct_traffic_entry_pages" HelpText="Entry pages for the visits that have started through a direct entry to your website (for example from a bookmark) and not through an external referrer or search engine.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/traffic_sources/direct_traffic_entry_pages
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsExternalReferringDomains" Title="External Referring Domains" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_traffic_sources_external_referring_domains" HelpText="External domains that have referred visitors to your website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/traffic_sources/external_referring_domains
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="external_referring_domain" Id="ReferringDomain" Title="Referring Domain" Converter="String"/>
				<JsonPath Expr="referring_pages" Id="ReferringPages" Title="Referring Pages" Converter="Long" DefaultValue=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsExternalReferringPages" Title="External Referring Pages" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_traffic_sources_external_referring_pages" HelpText="Pages on external domains that have referred visitors to your website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/traffic_sources/external_referring_pages
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="pages" Id="Pages" Title="Pages" Converter="Long" DefaultValue=""/>
				<JsonPath Expr="visits_of_parent" Id="VisitsOfParent" Title="Visits of Parent" Converter="Long"/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsExternalSearchTerms" Title="External Search Terms" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_traffic_sources_external_search_terms" HelpText="Search terms that have been used on external search engines to reach the website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/traffic_sources/external_search_terms
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
				<JsonPath Expr="external_search_term" Id="SearchTerm" Title="Search Term" Converter="String" DefaultValue=""/>
				<JsonPath Expr="pages" Id="Pages" Title="Pages" Converter="Long" DefaultValue=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" DefaultValue=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsExternalSearchEngines" Title="External Search Engines" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_traffic_sources_search_engines" HelpText="Search engines that have referred visitors to your website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/traffic_sources/search_engines
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="search_engine" Id="SearchEngine" Title="Search Engine" Converter="String" DefaultValue=""/>
				<JsonPath Expr="pages" Id="Pages" Title="Pages" Converter="Long" DefaultValue=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" DefaultValue=""/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsExternalSocialMedia" Title="External Social Media" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_traffic_sources_social_media_organisations" HelpText="Get the social media organisations that have referred visitors to your website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/traffic_sources/social_media_organisations
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="Long"/>
				<JsonPath Expr="organisation" Id="Site" Title="Site" Converter="String" DefaultValue=""/>
				<JsonPath Expr="pages" Id="Pages" Title="Pages" Converter="Long" DefaultValue=""/>
				<JsonPath Expr="referrals" Id="Referrals" Title="Referrals" Converter="Long" DefaultValue=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" DefaultValue=""/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsExternalSocialMediaSiteHistory" Title="External Social Media Site History" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_traffic_sources_social_media_organisations_social_media_organisation_id_history" HelpText="A series of historical data points showing the visits for the specified social media site.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <Text Id="SomeSiteId" Title="Social Media Site Id" Debug.DefaultValue="1" Required="true" Syntax="^\d+$"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/traffic_sources/social_media_organisations/@(Model.SomeSiteId)/history
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="timestamp" Id="Timestamp" Title="Timestamp" Converter="DateTime"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long"/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsBrowsers" Title="Browsers by Visitors" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_visitors_browsers" HelpText="Get the browsers used by your visitors.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/visitors/browsers
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="browser_name" Id="Browser" Title="Browser" Converter="String" DefaultValue=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" DefaultValue=""/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsCountries" Title="Countries of Visitors" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_visitors_countries" HelpText="Overview of where visitors come from divided by country.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/visitors/countries
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="Long"/>
				<JsonPath Expr="country_name" Id="Country" Title="Country" Converter="String"/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" DefaultValue=""/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsDevices" Title="Devices by Visitors" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_visitors_devices" HelpText="See which type of device is being utilised the most.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/visitors/devices
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="device_type" Id="Device" Title="Device" Converter="String"/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double"/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" DefaultValue=""/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AnalyticsOrganisations" Title="Organisations from Visitors" Group="Analytics Reports" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_visitors_organisations" HelpText="Get a list of visiting organisations, identified through IP address.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" Debug.DefaultValue="7157903272" Required="true" Syntax="^\d+$" Select.Connector="Sites"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/visitors/organisations
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@ReturnDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="Long"/>
				<JsonPath Expr="organisation" Id="Organisation" Title="Organisation" Converter="String"/>
				<JsonPath Expr="ip_addresses" Id="IPAddresses" Title="IPA ddresses" Converter="Long"/>
				<JsonPath Expr="pages" Id="Pages" Title="Pages" Converter="Long" DefaultValue=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" DefaultValue=""/>
      </JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RazorFunctions>
    <![CDATA[
    string CreateBasicAuth() {
      return Convert.ToBase64String(ASCIIEncoding.ASCII.GetBytes(Model.Email + ":" + Model.ApiKey));
    }

		string ReturnDate() {
			return Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null
				? "&period=" + Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd")) + "_" + Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
				: string.Empty;
		}
    ]]>
  </RazorFunctions>

</Suite>